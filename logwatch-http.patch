Index: scripts/services/http
===================================================================
RCS file: /var/cvs/logwatch/scripts/services/http,v
retrieving revision 1.9
diff -u -r1.9 http
--- scripts/services/http	3 Feb 2004 02:45:26 -0000	1.9
+++ scripts/services/http	15 Feb 2004 18:51:59 -0000
@@ -79,6 +79,8 @@
 my $wpad_bytes =     0;
 my $src_count =      0;
 my $src_bytes =      0;
+my $logs_count =     0;
+my $logs_bytes =     0;
 my $images_count =   0;
 my $images_bytes =   0;
 my $image_types =    '(\.bmp|\.emz|\.gif|\.ico|\.jpeg|\.jpg|\.png|\.swf|\.tif|\.tiff|\.wmf|\.wmz|\.xdm)';
@@ -88,14 +90,15 @@
    $content_types =  $content_types.'|\.php|\.php3|\.asp|\.pl|\.wml|\/';
    $content_types =  $content_types.'|\.css|\.js|\.cgi|\.txt|\/';
    $content_types =  $content_types.'|\.class|\.jsp|\.jar|\.java)';
-my $docs_types =     '(\.doc|\.dvi|\.gnumeric|\.mcd|\.mso|\.pdf|\.pps|\.ppt|\.ps|\.rtf|\.tex|\.text|\.xls|\.xml)';
-my $archive_types =  '(\.ace|\.bz2|\.cab|\.deb|\.gz|\.hqx|\.rar|\.rpm|\.tbz2|\.zip)';
+my $docs_types =     '(\.doc|\.dot|\.dvi|\.gnumeric|\.mcd|\.mso|\.pdf|\.pps|\.ppt|\.ps|\.rtf|\.tex|\.text|\.xls|\.xml)';
+my $archive_types =  '(\.ace|\.bz2|\.cab|\.deb|\.gz|\.hqx|\.rar|\.rpm|\.tbz2|\.Z|\.zip)';
 my $sound_types =    '(\.mp3|\.ram|\.raw|\.rm|\.wav|\.wma|\.mid)';
-my $movie_types =    '(\.asf|\.avi|\.mid|\.mpg|\.mpeg|\.mov)';
+my $movie_types =    '(\.asf|\.ass|\.avi|\.idx|\.mid|\.mpg|\.mpeg|\.mov|\.sub)';
 my $winexec_types =  '(\.com|\.exe|\.dll)';
 my $wpad_files =     '(wpad\.dat|wspad\.dat|proxy\.pac)';
 my $program_src =    '(\.bas|\.c|\.diff|\.f|\.h|\.patch|\.cpp)';
 my $images_types =   '(\.bin|\.cue|\.iso|\.run)';
+my $logs_types =     '(\.log|\.logs)';
 
 #
 #   what to look for as an attack  USE LOWER CASE!!!!!!
@@ -238,6 +241,9 @@
    } elsif ($field{base_url} =~ /$images_types$/) {
       $images_count += 1;
       $images_bytes += $field{bytes_transfered};
+   } elsif ($field{base_url} =~ /$logs_files$/) {
+      $logs_count += 1;
+      $logs_bytes += $field{bytes_transfered};
    } elsif ($field{http_rc} =~ /3\d\d/) {
       $redirect_count += 1;
       $redirect_bytes += $field{bytes_transfered};
@@ -293,7 +299,7 @@
    print " responses ";
    print " (1xx $a1xx_resp, 2xx $a2xx_resp, 3xx $a3xx_resp,";
    print " 4xx $a4xx_resp, 5xx $a5xx_resp) \n";
-   print	  " $image_count Images ($image_bytes bytes),\n";
+   print   " $image_count Images ($image_bytes bytes),\n";
    print   " $docs_count Documents ($docs_bytes bytes),\n";
    print   " $archive_count Archives ($archive_bytes bytes),\n";
    print   " $sound_count Sound files ($sound_bytes bytes),\n";
@@ -304,6 +310,7 @@
    print   " $wpad_count Proxy Configuration Files ($wpad_bytes bytes),\n";
    print   " $src_count Program source files ($src_bytes bytes),\n";
    print   " $images_count CD Images ($images_bytes bytes),\n"; 
+   print   " $logs_count various Logs ($logs_bytes bytes),\n";
    print	  " $other_count Other ($other_bytes bytes) \n";
 }
 
