Index: scripts/services/http
===================================================================
RCS file: /var/cvs/logwatch/scripts/services/http,v
retrieving revision 1.18
diff -u -r1.18 http
--- scripts/services/http	17 Apr 2005 19:12:14 -0000	1.18
+++ scripts/services/http	25 Apr 2005 12:23:56 -0000
@@ -44,7 +44,6 @@
 ########################################################
 
 
-use diagnostics;
 use strict;
 use Logwatch ':sort';
 # use re "debug";
@@ -115,6 +114,10 @@
 my $fonts_bytes =    0;
 my $config_count =   0;
 my $config_bytes =   0;
+my $xpcomext_count = 0;
+my $xpcomext_bytes = 0;
+my $mozext_count =   0;
+my $mozext_bytes =   0;
 my $proxy_count =    0;
 my $proxy_bytes =    0;
 my %proxy_host =     ();
@@ -132,22 +135,24 @@
    $content_types =  $content_types.'|^\/announce|^\/scrape'; # BitTorrent tracker mod_bt
    $content_types =  $content_types.'|\.torrent';
    $content_types =  $content_types.'|\.css|\.js|\.cgi';
-   $content_types =  $content_types.'|\.fla|\.swf';
+   $content_types =  $content_types.'|\.fla|\.swf|\.rdf';
    $content_types =  $content_types.'|\.class|\.jsp|\.jar|\.java';
    $content_types =  $content_types.'|COPYRIGHT|readme|README|FAQ|INSTALL|\.txt)';
-my $docs_types =     '(\.asc|\.djvu|\.doc|\.dot|\.dvi|\.gnumeric|\.mcd|\.mso|\.pdf|\.pps|\.ppt|\.ps|\.rtf|\.sxi|\.tex|\.text|\.tm|\.xls|\.xml)';
+my $docs_types =     '(\.asc|\.djvu|\.doc|\.dot|\.dtd|\.dvi|\.gnumeric|\.mcd|\.mso|\.pdf|\.pps|\.ppt|\.ps|\.rtf|\.sxi|\.tex|\.text|\.tm|\.xls|\.xml)';
 my $archive_types =  '(\.ace|\.bz2|\.cab|\.deb|\.dsc|\.ed2k|\.gz|\.hqx|\.md5|\.rar|\.rpm|\.sig|\.sign|\.tar|\.tbz2|\.tgz|\.vl2|\.Z|\.zip)';
-my $sound_types =    '(\.au|\.mid|\.mp3|\.ogg|\.pls|\.ram|\.raw|\.rm|\.wav|\.wma|\.wmv|\.xsm)';
+my $sound_types =    '(\.au|\.aud|\.mid|\.mp3|\.ogg|\.pls|\.ram|\.raw|\.rm|\.wav|\.wma|\.wmv|\.xsm)';
 my $movie_types =    '(\.asf|\.ass|\.avi|\.idx|\.mid|\.mpg|\.mpeg|\.mov|\.qt|\.psb|\.srt|\.ssa|\.smi|\.sub)';
 my $winexec_types =  '(\.bat|\.com|\.exe|\.dll)';
 my $wpad_files =     '(wpad\.dat|wspad\.dat|proxy\.pac)';
 my $program_src =    '(';
-   $program_src =    $program_src.'\.bas|\.c|\.cpp|\.diff|\.f|\.h|\.init|\.m|\.pas|\.patch|\.spec';
+   $program_src =    $program_src.'\.bas|\.c|\.cpp|\.diff|\.f|\.h|\.init|\.m|\.mo|\.pas|\.patch|\.po|\.pot|\.sh|\.spec';
    $program_src =    $program_src.'|Makefile|Makefile_c|Makefile_f77)';
 my $images_types =   '(\.bin|\.cue|\.img|\.iso|\.run)';
 my $logs_types =     '(\.log|_log|-log|\.logs|\.out|\.wyniki)';
 my $fonts_types =    '(\.aft|\.ttf)';
-my $config_types =   '(\.cfg|\.conf|\.config|\.ini)';
+my $config_types =   '(\.cfg|\.conf|\.config|\.ini|\.properties)';
+my $xpcomext_types = '(\.xpt)';
+my $mozext_types =   '(\.xul)';
 
 # HTTP Status codes from HTTP/Status.pm, to avoid loading package
 # that may or may not exist.  We only need those >=400, but all
@@ -385,6 +390,12 @@
    } elsif ($field{base_url} =~ /$config_types$/o) {
       $config_count += 1;
       $config_bytes += $field{bytes_transfered};
+   } elsif ($field{base_url} =~ /$xpcomext_types$/) {
+      $xpcomext_count += 1;
+      $xpcomext_bytes += $field{bytes_transfered};
+   } elsif ($field{base_url} =~ /$mozext_types$/) {
+      $mozext_count += 1;
+      $mozext_bytes += $field{bytes_transfered};
    } elsif ($field{http_rc} =~ /3\d\d/) {
       $redirect_count += 1;
       $redirect_bytes += $field{bytes_transfered};
@@ -462,6 +473,8 @@
    if ($logs_count > 0)       { printf "   %*d Various Logs (%.2f MB),\n" , $lr, $logs_count, $logs_bytes/(1024*1024); }
    if ($fonts_count > 0)      { printf "   %*d Fonts (%.2f MB),\n" , $lr, $fonts_count, $fonts_bytes/(1024*1024); }
    if ($config_count > 0)     { printf "   %*d Configs (%.2f MB),\n" , $lr, $config_count, $config_bytes/(1024*1024); }
+   if ($xpcomext_count > 0)   { printf "   %*d XPCOM Type Libraries (%.2f MB),\n" , $lr, $xpcomext_count, $xpcomext_bytes/(1024*1024); }
+   if ($mozext_count > 0)     { printf "   %*d Mozilla extensions (%.2f MB),\n" , $lr, $mozext_count, $mozext_bytes/(1024*1024); }
    if ($proxy_count > 0)      { printf "   %*d mod_proxy requests (%.2f MB),\n" , $lr, $proxy_count, $proxy_bytes/(1024*1024); }
    if ($other_count > 0)      { printf "   %*d Other (%.2f MB) \n" , $lr, $other_count, $other_bytes/(1024*1024); }
 }
