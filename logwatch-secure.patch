Index: scripts/services/secure
===================================================================
RCS file: /var/cvs/logwatch/scripts/services/secure,v
retrieving revision 1.47
diff -u -r1.47 secure
--- scripts/services/secure	29 Oct 2004 21:19:01 -0000	1.47
+++ scripts/services/secure	31 Oct 2004 16:21:30 -0000
@@ -67,17 +67,18 @@
    $temp =~ s/^([^[]+).*/$1/;
    if ($Ignore =~ /\b\Q$temp\E\b/i) { next; }
    if (
-      ( $ThisLine =~ /pam_succeed_if: requirement "uid < 100" not met by user /) or
+      ( $ThisLine =~ /^(.*)\(pam_unix\)/) or
       ( $ThisLine =~ m/^[^ ]+\[\d+\]: connect from localhost$/ ) or
       ( $ThisLine =~ /^\/usr\/bin\/sudo:/) or
-      ( $ThisLine =~ /^sudo:/) or
       ( $ThisLine =~ /^halt:/) or
-      ( $ThisLine =~ /^reboot:/) or
       ( $ThisLine =~ /^pam_xauth\[\d+\]: call_xauth: child returned \d/) or
       ( $ThisLine =~ /^passwd\[\d+\]:/) or
-      ( $ThisLine =~ /warning: can.t get client address: Connection refused/) or
+      ( $ThisLine =~ /^reboot:/) or
+      ( $ThisLine =~ /^sudo:/) or
       ( $ThisLine =~ /^xinetd\[\d+\]: USERID: ([^ ]+) (.+)$/ ) or
-      ( $ThisLine =~ /^(xinetd|xinetd-ipv6)\[\d+\]: EXIT: /)
+      ( $ThisLine =~ /^(xinetd|xinetd-ipv6)\[\d+\]: EXIT: /) or
+      ( $ThisLine =~ /pam_succeed_if: requirement "uid < 100" not met by user /) or
+      ( $ThisLine =~ /warning: can.t get client address: Connection refused/)
    ) {
       # Ignore these entries
    } elsif ($ThisLine =~ /^spop3d/) {
@@ -446,5 +447,4 @@
 
 exit(0);
 
-# vi: shiftwidth=3 tabstop=3 et
-
+# vi: shiftwidth=3 tabstop=3 syntax=perl et
