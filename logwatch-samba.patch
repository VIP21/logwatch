Index: scripts/services/samba
===================================================================
RCS file: /var/cvs/logwatch/scripts/services/samba,v
retrieving revision 1.19
diff -u -r1.19 samba
--- scripts/services/samba	23 Jun 2004 15:01:17 -0000	1.19
+++ scripts/services/samba	1 Jul 2004 10:35:21 -0000
@@ -106,6 +106,10 @@
       $SocketWriteError++;
 	} elsif ( ( $ThisLine =~ /unable to open passdb database.$/ ) ) {
 		$DbOpenFail++;
+   } elsif ( ($Name,$Group,$Subnet) = ( $ThisLine =~ /pdb_smbpasswd.c:pdb_getsampwnam\(\d+\)  unable to open passdb database\.  [ *]+Samba name server ([^ ]+) is now a local master browser for workgroup ([^ ]+) on subnet ([^ ]+)   / )) {
+      $Temp = "$Where  ($Ip)";
+      $DbOpenFail++;
+      $BeLocalMaster{$Subnet}{$Group}{$Name}++;
 	} elsif ( ($Server,$Ip,$Group) = ($ThisLine =~ /Server ([^ ]+) at IP ([^ ]+) is announcing itself as a local master browser for workgroup ([^ ]+) and we think we are master. Forcing election.$/ ) ) {
 		$Temp = $Server . "(" . $Ip . ")";
 		$ForceElection{$Group}{$Temp}++;
